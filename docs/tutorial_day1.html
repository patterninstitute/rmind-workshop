<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R-Mind - Day1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R-Mind</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./prerequisites.html" rel="" target="">
 <span class="menu-text">Prerequisites</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorials">    
        <li>
    <a class="dropdown-item" href="./introduction_day1.html" rel="" target="">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tutorial_day1.html" rel="" target="">
 <span class="dropdown-text">Day1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tutorial_day2.html" rel="" target="">
 <span class="dropdown-text">Day2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tutorial_day3.html" rel="" target="">
 <span class="dropdown-text">Day3</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-extra-tutorials" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Extra tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-extra-tutorials">    
        <li>
    <a class="dropdown-item" href="./1_swirl_tutorial.html" rel="" target="">
 <span class="dropdown-text">R4AB | Swirl tutorial</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./2_hands_on_tutorial.html" rel="" target="">
 <span class="dropdown-text">R4AB | Hands on tutorial</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./3_self_eval_exam.html" rel="" target="">
 <span class="dropdown-text">R Self-evaluation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./4_tidy_data_visualization.html" rel="" target="">
 <span class="dropdown-text">Tidy data &amp; Visualization with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./5_ggplot_intro.html" rel="" target="">
 <span class="dropdown-text">ggplot2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">ESN-ISN Neurochemistry School</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./contacts.html" rel="" target="">
 <span class="menu-text">Contacts</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#basic-data-analysis-lesson-1" id="toc-basic-data-analysis-lesson-1" class="nav-link active" data-scroll-target="#basic-data-analysis-lesson-1">Basic data analysis | Lesson 1</a>
  <ul class="collapse">
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives">Learning Objectives</a></li>
  <li><a href="#the-dataset" id="toc-the-dataset" class="nav-link" data-scroll-target="#the-dataset">The dataset</a></li>
  </ul></li>
  <li><a href="#hands-on-exercises" id="toc-hands-on-exercises" class="nav-link" data-scroll-target="#hands-on-exercises">Hands-on exercises</a>
  <ul class="collapse">
  <li><a href="#a.-create-a-new-project-in-rstudio" id="toc-a.-create-a-new-project-in-rstudio" class="nav-link" data-scroll-target="#a.-create-a-new-project-in-rstudio">A. Create a new project in RStudio</a></li>
  <li><a href="#b.-load-the-data-and-inspect-it" id="toc-b.-load-the-data-and-inspect-it" class="nav-link" data-scroll-target="#b.-load-the-data-and-inspect-it">B. Load the data and inspect it</a></li>
  <li><a href="#c.-answer-the-following-questions-using-r" id="toc-c.-answer-the-following-questions-using-r" class="nav-link" data-scroll-target="#c.-answer-the-following-questions-using-r">C. Answer the following questions using R</a></li>
  <li><a href="#final-discussion" id="toc-final-discussion" class="nav-link" data-scroll-target="#final-discussion">Final discussion</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Day1</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="basic-data-analysis-lesson-1" class="level2">
<h2 class="anchored" data-anchor-id="basic-data-analysis-lesson-1">Basic data analysis | Lesson 1</h2>
<section id="learning-objectives" class="level3">
<h3 class="anchored" data-anchor-id="learning-objectives">Learning Objectives</h3>
<ol type="1">
<li>How to import datasets into R.<br>
</li>
<li>Conduct descriptive statistics on the dataset to explore the data.<br>
</li>
<li>Basic data visualization with histograms, boxplots, and scatterplots.<br>
</li>
<li>How to calculate the correlation between 2 (numerical) variables.<br>
</li>
<li>How to make a simple linear regression, and plot the line in the scatterplot.<br>
</li>
<li>Conduct a t-test for basic hypothesis testing.<br>
</li>
<li>Recognize the differences between base R plotting and using the ggplots2 package.</li>
</ol>
</section>
<section id="the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="the-dataset">The dataset</h3>
<p><strong>The scientific experiment</strong> | Imagine that you are interested in determining the effects of a high-fat diet on gene expression. For this study, the scientists obtained data from 60 mice, where half were fed a lean-diet, and the other half a high-fat diet. All other living conditions were the same. Four weeks after, a biopsy of the mice’s liver was sequenced by RNA-seq, and all mice were weighted, and the sex and age were also recorded. The results from this analysis are saved in <em>diet_mice_metadata.txt</em> file, and the gene counts are in the file <em>diet_mice_counts.xlsx</em>.</p>
<section id="think-about-the-experimental-design" class="level4">
<h4 class="anchored" data-anchor-id="think-about-the-experimental-design">Think about the experimental design</h4>
<ul>
<li>What is the research question? What is the hypothesis?</li>
<li>How many variables are in the study?</li>
<li>Which variable(s) are dependent? (Dependent or Response variables are the variables that we are interested in predicting or explaining.)</li>
<li>Which variable(s) are independent? (Independent or Explanatory variables are used to explain or predict the dependent variable.)</li>
<li>Which variable(s) are covariates? (Covariates are variables that are potentially related to the outcome of interest in a study, but are not the main variable under study - used to control for potential confounding factors in a study.)</li>
<li>Are the “controls” appropriate? Why?</li>
</ul>
</section>
</section>
</section>
<section id="hands-on-exercises" class="level2">
<h2 class="anchored" data-anchor-id="hands-on-exercises">Hands-on exercises</h2>
<p>We will start by looking at the <code>metadata file</code> containing the variables related to each sample (i.e.&nbsp;each mouse): <code>type of diet, final weight, gender, and age in months</code>.</p>
<section id="a.-create-a-new-project-in-rstudio" class="level3">
<h3 class="anchored" data-anchor-id="a.-create-a-new-project-in-rstudio">A. Create a new project in RStudio</h3>
<p>Start by creating a new project in RStudio. Go to <code>File &gt; New project</code>, and follow the instructions.<br>
Once you have are in the project folder, create a new R script file. Go to <code>File &gt; New File &gt; R Script</code>. A blank text file will appear above the console. Save it in your project folder with the name <code>diet_analysis.R</code>.</p>
</section>
<section id="b.-load-the-data-and-inspect-it" class="level3">
<h3 class="anchored" data-anchor-id="b.-load-the-data-and-inspect-it">B. Load the data and inspect it</h3>
<ol type="1">
<li>Download the file <code>diet_mice_metadata.txt</code> (mice weights according to diet) from GitHub <a href="https://github.com/patterninstitute/rmind-workshop/blob/main/data/diet_mice_metadata.txt" class="uri">https://github.com/patterninstitute/rmind-workshop/blob/main/data/diet_mice_metadata.txt</a>.<br>
</li>
<li>Save the file in your current working directory where the RProject was created inside a folder named <code>data</code>.<br>
</li>
<li>Type the instructions inside grey boxes in pane number 2 of RStudio — the R Console. As you already know, the words after a <code>#</code> sign are comments not interpreted by R, so you do not need to copy them.
<ul>
<li>In the <strong>R console</strong>, you must hit <strong><code>enter</code> after each command</strong> to obtain the result.<br>
</li>
<li>In the <strong>script file</strong> (R file), you must <strong><code>run</code></strong> the command by <strong>pressing the run button</strong> (on the top panel), or by <strong>selecting the code</strong> you want to run <strong>and pressing <code>ctrl + enter</code></strong>.<br>
</li>
</ul></li>
<li>Save all your relevant/final commands (R instructions) to your script file to be available for later use.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)     <span class="co"># to ease data wrangling and visualization</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)          <span class="co"># to help with file paths </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)  <span class="co"># color palettes</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)     <span class="co"># combine plots in panels for figures</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the file and save it to object mice_data</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>mice_data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file=</span><span class="fu">here</span>(<span class="st">"data/diet_mice_metadata.txt"</span>), </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">dec =</span> <span class="st">"."</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="c.-answer-the-following-questions-using-r" class="level3">
<h3 class="anchored" data-anchor-id="c.-answer-the-following-questions-using-r">C. Answer the following questions using R</h3>
<section id="briefly-explore-the-dataset." class="level4">
<h4 class="anchored" data-anchor-id="briefly-explore-the-dataset.">1. Briefly explore the dataset.</h4>
<p>We should use descriptive statistics that summarize the sample data. We will use measures of central tendency — <em>Mean, Median, and Mode</em> —, and measures of dispersion (or variability) — <em>Standard Deviation, Variance, Maximum, and Minimum</em>.</p>
</section>
<section id="how-is-the-variable-mouse-weight-distributed" class="level4">
<h4 class="anchored" data-anchor-id="how-is-the-variable-mouse-weight-distributed">2. How is the variable “mouse weight” distributed?</h4>
<p>After summarizing the data, we should find appropriate plots to look at it. A first approach is to look at the frequency of the mouse weight values using a histogram.</p>
</section>
<section id="how-is-the-variable-mouse-weight-distributed-in-each-diet" class="level4">
<h4 class="anchored" data-anchor-id="how-is-the-variable-mouse-weight-distributed-in-each-diet">3. How is the variable “mouse weight” distributed in each diet?</h4>
<p>Since our data of interest is one categorical variable (type of diet), and one continuous variable (weight), a boxplot is one of the most informative.</p>
</section>
<section id="how-are-the-other-variables-distributed" class="level4">
<h4 class="anchored" data-anchor-id="how-are-the-other-variables-distributed">4. How are the other variables distributed?</h4>
<p>There are other variables in our data for each mouse that could influence the results, namely gender (categorical variable) and age (discrete variable). We should also look at these data.</p>
</section>
<section id="what-is-the-frequency-of-each-variable" class="level4">
<h4 class="anchored" data-anchor-id="what-is-the-frequency-of-each-variable">5. What is the frequency of each variable?</h4>
<ul>
<li>5.1 How many measurements do we have for each gender?</li>
<li>5.2 How many measurements do we have for each diet?</li>
<li>5.3 How many measurements do we have for each gender in each diet?</li>
<li>5.4 What if we want to know the results for each of the three variables: age, diet, and gender?</li>
</ul>
</section>
<section id="is-there-a-dependency-between-the-age-and-the-weight-of-the-mice-in-our-study" class="level4">
<h4 class="anchored" data-anchor-id="is-there-a-dependency-between-the-age-and-the-weight-of-the-mice-in-our-study">6. Is there a dependency between the age and the weight of the mice in our study?</h4>
</section>
<section id="is-the-correlation-between-the-age-and-the-weight-of-the-mice-different-for-males-and-females" class="level4">
<h4 class="anchored" data-anchor-id="is-the-correlation-between-the-age-and-the-weight-of-the-mice-different-for-males-and-females">7. Is the correlation between the age and the weight of the mice different for males and females?</h4>
</section>
<section id="is-the-correlation-between-the-age-and-the-weight-of-the-mice-different-for-different-diets" class="level4">
<h4 class="anchored" data-anchor-id="is-the-correlation-between-the-age-and-the-weight-of-the-mice-different-for-different-diets">8. Is the correlation between the age and the weight of the mice different for different diets?</h4>
</section>
<section id="does-the-type-of-diet-influence-the-body-weight-of-mice" class="level4">
<h4 class="anchored" data-anchor-id="does-the-type-of-diet-influence-the-body-weight-of-mice">9. Does the type of diet influence the body weight of mice?</h4>
<p>Can we answer this question just by looking at the plot? Are these observations compatible with a scenario where <em>the type of diet does not influence body weight?</em></p>
<p><br></p>
</section>
<section id="now-that-we-have-calculated-the-t-test-shall-we-accept-or-reject-the-null-hypothesis-what-are-the-outputs-in-r-from-the-t-test" class="level4">
<h4 class="anchored" data-anchor-id="now-that-we-have-calculated-the-t-test-shall-we-accept-or-reject-the-null-hypothesis-what-are-the-outputs-in-r-from-the-t-test">10. Now that we have calculated the T-test, shall we accept or reject the null hypothesis? What are the outputs in R from the t-test?</h4>
</section>
</section>
<section id="final-discussion" class="level3">
<h3 class="anchored" data-anchor-id="final-discussion">Final discussion</h3>
<blockquote class="blockquote">
<blockquote class="blockquote">
<p>Take some time to discuss the results with the other participants, and decide if H0 should be rejected or not, and how confident you are that your decision is reasonable. Can you propose solutions to improve your confidence on the results? Is the experimental design appropriate for the research question being asked? Is this experiment well controlled and balanced?</p>
</blockquote>
</blockquote>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>